<!DOCTYPE html>
<html lang="en" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <link rel="icon" href="https://github.com/MerpatiQuu/Home/blob/main/WhatsApp%20Image%202024-12-17%20at%2021.35.48.jpeg?raw=true" type="image/x-icon" />
  <meta property="og:image" content="https://github.com/MerpatiQuu/Home/blob/main/WhatsApp%20Image%202024-12-17%20at%2021.35.48.jpeg?raw=true" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.9.1/font/bootstrap-icons.min.css" rel="stylesheet">
    <title>Kayawan - Toko Beddian</title>
    <style>
/* Global Styles */
body {
    padding: 15px;
    font-family: Arial, sans-serif;
    background-color: #4CAF50; /* Light gray background */
}
html {
            -webkit-user-select: none; /* Nonaktifkan seleksi teks otomatis */
            -webkit-tap-highlight-color: transparent; /* Nonaktifkan highlight saat menekan layar */
        }
.round-icon-container {
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #007bff; /* Warna latar belakang */
    border-radius: 50%; /* Membuat kotak bulat */
    width: 50px; /* Ukuran kotak */
    height: 50px; /* Ukuran kotak */
    cursor: pointer; /* Tanda pointer saat diklik */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Efek bayangan */
    position: absolute; /* Menempatkan di tengah halaman */
    top: 18%; /* Menempatkan di tengah secara vertikal */
    left: 50%; /* Menempatkan di tengah secara horizontal */
    transform: translate(-50%, -50%); /* Memindahkan dari posisi top dan left 50% */
transition: box-shadow 0.3s ease, transform 0.3s ease; /* Efek transisi untuk perubahan bayangan dan transformasi */
}

.round-icon-container:hover {
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3); /* Efek bayangan lebih dalam saat mouse hover untuk efek ngambang yang lebih nyata */
    transform: translate(-50%, -50%) translateY(-10px); /* Menaikkan ikon sedikit untuk efek ngambang */
}

.round-icon-container i {
    color: white; /* Sesuaikan warna ikon dengan header */
    font-size: 24px; /* Ukuran ikon */
    transition: color 0.3s ease; /* Efek transisi untuk perubahan warna */
}

.round-icon-container:hover i {
    color: yellow; /* Warna ikon saat mouse hover untuk efek menarik */
}
.curved-background {
    position: absolute; /* Posisi relatif terhadap tubuh */
    width: 100%;
    height: 100px;
    background-color: #FFFFFF; /* Warna putih */
    border-bottom-left-radius: 50% 40px;
    border-bottom-right-radius: 50% 40px;
    z-index: 0;
    top: 0; /* Posisikan di bagian atas halaman */
    display: flex;
    justify-content: center;
    align-items: center;
    left: 0; /* Membuat curve ini mencapai batas kiri halaman */
}



@keyframes fallDown {
    from {
        opacity: 0;
        transform: translateY(-100px); /* Mulai di atas halaman */
    }
    to {
        opacity: 1;
        transform: translateY(0); /* Jatuh ke posisi semula */
    }
}

.falling-image {
    width: 190px; /* Perkecil ukuran gambar */
    animation: fallDown 2s ease-out; /* Animasi jatuh selama 2 detik */
    display: block;
}

/* Main content */
    main {
      margin-left: 0;
      margin-top: 40px; /* Start below the header */
      padding: 20px;
    }


/* Table Styles */
.table {
    width: 100%; /* Lebar penuh */
    border-collapse: collapse;
    margin-bottom: 20px;
}

.table th,
.table td {
    padding: 8px 12px; /* Padding yang diperkecil untuk lebih kompak */
    border: 1px solid #dee2e6; /* Warna batas ringan */
    text-align: left;
}

.table th {
    background-color: #007bff; /* Warna latar belakang header */
    color: white; /* Warna teks header */
}

.table tr:nth-child(even) {
    background-color: #f2f2f2; /* Warna latar belakang untuk baris genap */
}

.table td {
    background-color: white; /* Warna latar belakang untuk isi data */
    word-wrap: break-word; /* Memastikan teks tidak terpotong */
    white-space: normal; /* Memungkinkan teks berpindah baris */
    max-width: 100%; /* Tabel otomatis menyesuaikan lebar sesuai konten */
    overflow: hidden; /* Menghentikan teks keluar dari sel */
    text-overflow: ellipsis; /* Menunjukkan '...' jika teks terpotong */
}

/* Button Styles */
.btn-custom {
    background-color: #007bff;
    color: white;
    padding: 8px 15px; /* Compact button padding */
    border: none;
    border-radius: 4px; /* Rounded corners */
    cursor: pointer;
    
}

.btn-custom:hover {
    background-color: #0056b3; /* Darker shade on hover */
}
.btn-group {
    display: flex; /* Menjadikan elemen dalam grup menjadi satu baris */
    gap: 5px; /* Jarak antara tombol */
}

.btn {
    display: flex; /* Memastikan tombol tetap rapi */
    align-items: center; /* Menjaga ikon dan teks tetap pada tengah */
    justify-content: center; /* Menjaga ikon tetap di tengah */
}

/* Modal Styles */
.modal-header {
    background-color: #007bff;
    color: white;
}

.modal-body {
    padding: 20px; /* Padding inside modal body */
}

.modal-footer {
    padding: 10px;
    border-top: 1px solid #dee2e6;
}

/* Form Styles */
.form-group {
    margin-bottom: 15px; /* Reduced margin for compactness */
}

.form-control {
    padding: 10px; /* Compact input field padding */
    border: 1px solid #ced4da; /* Light border for input */
    border-radius: 4px; /* Rounded corners for input */
}
.container {margin-top: 100px}
/* Responsive Styles */
@media (max-width: 768px) {
    body {
        padding: 10px; /* Less padding on smaller screens */
    }
    
    .table th,
    .table td {
        padding: 6px 10px; /* Further reduced padding on small screens */
    }

    .btn-custom {
        width: 100%; /* Full width buttons on small screens */
    }
}
.hidden-column {
    display: none; /* Menyembunyikan kolom */
}
.visually-hidden {
    visibility: hidden;
    height: 0;
    margin: 0;
    padding: 0;
}
.loader {
        position: fixed;
        top: 37%;
        left: 42%;
        transform: translate(-50%, -50%);
        z-index: 9999;
        display: none; /* Disembunyikan secara default */
        border: 16px solid #f3f3f3; /* Light grey */
        border-top: 16px solid #048023; /* Dark Green */
        border-radius: 50%;
        width: 80px; /* Ukuran lebih kecil */
        height: 80px; /* Ukuran lebih kecil */
        animation: spinloader 2s linear infinite;
    }
    
    .loader img {
        height: 80px; /* Ukuran lebih kecil */
        width: 80px; /* Ukuran lebih kecil */
        animation: spinlogo 2s linear infinite;
    }
    
    @keyframes spinloader {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    @keyframes spinlogo {
        0% { transform: rotate(360deg); }
        100% { transform: rotate(0deg); }
    }
    </style>
</head>
<body>
    <div class="curved-background">
        <img src="https://github.com/MerpatiQuu/Home/blob/main/WhatsApp_Image_2024-12-14_at_07.39.02_9892515b-removebg-preview.png?raw=true" alt="Toko Beddian" class="falling-image">
    </div>
        <div class="round-icon-container" onclick="window.location.href = 'index.html';">
    <i class="bi bi-house-door"></i>
</div> 
    <div class="container">

    <button class="btn btn-primary mb-3" data-toggle="modal" data-target="#dataModal">
        <i class="fas fa-plus"></i> Tambah
    </button>
    
    <table class="table table-bordered" id="dataTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nama</th>
                <th>Bon</th>
                <th>Keterangan</th>
                <th>Aksi</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be populated here -->
        </tbody>
    </table>

    <!-- Loader yang akan muncul di bawah tabel -->
    <div class="loader" style="display: none;">
        <img src="https://github.com/MerpatiQuu/Home/blob/main/WhatsApp_Image_2024-12-14_at_07.39.02_9892515b-removebg-preview.png?raw=true" />
    </div>
</div>

    <!-- Modal for Add/Update -->
<!-- Modal untuk Menambah Data Tagihan -->
<div class="modal fade" id="addDataModal" tabindex="-1" role="dialog" aria-labelledby="addDataModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addDataModalLabel">Tambah</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="addForm">
                    <div class="form-group">
                        <label for="addID" class="form-control visually-hidden">ID</label>
                        <input type="text" class="form-control visually-hidden" id="addID" name="ID" required>
                    </div>
                    <div class="form-group">
                        <label for="addNama">Nama</label>
                        <input type="text" class="form-control" id="addNama" name="Nama" required>
                    </div>
                    <button type="button" class="btn btn-primary" id="addSaveButton">Save</button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Modal untuk Memperbarui Data Tagihan -->
<div class="modal fade" id="updateDataModal" tabindex="-1" role="dialog" aria-labelledby="updateDataModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="updateDataModalLabel">Update</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="updateForm">
                    <input type="hidden" name="action" value="Update">
                    <div class="form-group">
                        <label for="updateID" class="form-control visually-hidden">ID</label>
                        <input type="text" class="form-control visually-hidden" id="updateID" name="ID" required>
                    </div>

                    <div class="form-group">
                        <label for="updateNama">Nama</label>
                        <input type="text" class="form-control" id="updateNama" name="Nama" required>
                    </div>
                    <div class="form-group">
                        <label for="updateBon">Bon</label>
                        <input type="text" class="form-control" id="updateBon" name="Bon" required>
                    </div>
                    <div class="form-group">
                        <label for="updateKet">Keterangan</label>
                        <input type="text" class="form-control" id="updateKet" name="Ket" required>
                    </div>
                    <button type="button" class="btn btn-primary" id="updateSaveButton">Update</button>
                </form>
            </div>
        </div>
    </div>
</div>
      
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
$(document).ready(function() {
    // Fetch and display data immediately after the page is loaded
    fetchData();

    // Function to fetch and display data
    function fetchData() {
        $.getJSON('https://script.google.com/macros/s/AKfycbw3X4uIzp7cJn18PEVjcLFSMawp68gTDtzSaNCAyzshwSoXwfl9CMVXrQ2aMOhyet5wzg/exec?action=FetchData', function(data) {
            const tableBody = $('#dataTable tbody');
            tableBody.empty();
            data.forEach(function(row) {
                // Format Tanggal
                const formattedTanggal = row.Tanggal ? new Date(row.Tanggal).toLocaleDateString('id-ID') : '';
                const formattedTgl = row.Tempo ? new Date(row.Tempo).toLocaleDateString('id-ID') : '';

                // Format Currency
                const formattedTagihan = row.Tagihan ? parseInt(row.Tagihan).toLocaleString('id-ID', { minimumFractionDigits: 0 }) : '';
                const formattedBayar = row.Bayar ? parseInt(row.Bayar).toLocaleString('id-ID', { minimumFractionDigits: 0 }) : '';
                const formattedSisa = row.Sisa ? parseInt(row.Sisa).toLocaleString('id-ID', { minimumFractionDigits: 0 }) : '';

                // Append to table
                tableBody.append(`
                    <tr>
                        <td>${row.ID}</td>
                        <td>${row.Nama}</td>
                        <td>${row.Bon}</td>
                        <td>${row.Ket}</td>
                        
                        <td>
    <div class="btn-group">
        <button class="btn btn-warning btn-sm edit" data-id="${row.ID}">
            <i class="fas fa-edit"></i> <!-- Ikon edit -->
        </button>
        <button class="btn btn-danger btn-sm delete" data-id="${row.ID}" onclick="confirmDelete(event)">
    <i class="fas fa-trash-alt"></i> <!-- Ikon hapus -->
</button>

    </div>
</td>
                    </tr>
                `);
            });
        });
    }

    // Form submission for adding data
    $('#addSaveButton').on('click', function(event) {
        event.preventDefault();
        
        // Add the action parameter to the serialized data
        const formData = $('#addForm').serialize() + '&action=Add'; // Add action parameter

        $.post('https://script.google.com/macros/s/AKfycbw3X4uIzp7cJn18PEVjcLFSMawp68gTDtzSaNCAyzshwSoXwfl9CMVXrQ2aMOhyet5wzg/exec', formData, function(response) {
            alert(response.success || response.error);
            $('#addDataModal').modal('hide');
            fetchData(); // Refresh the table data
        }, 'json');
    });

    // Form submission for updating data
    $('#updateSaveButton').on('click', function(event) {
        event.preventDefault();
        $.post('https://script.google.com/macros/s/AKfycbw3X4uIzp7cJn18PEVjcLFSMawp68gTDtzSaNCAyzshwSoXwfl9CMVXrQ2aMOhyet5wzg/exec', $('#updateForm').serialize(), function(response) {
            alert(response.success || response.error);
            $('#updateDataModal').modal('hide');
            fetchData(); // Refresh the table data
        }, 'json');
    });

    $(document).on('click', '.edit', function() {
    const row = $(this).closest('tr');
    const id = row.find('td:eq(0)').text();
    const nama = row.find('td:eq(1)').text();
    const bon = row.find('td:eq(2)').text(); 
    const ket = row.find('td:eq(3)').text();
    

    $('#updateID').val(id);
    $('#updateNama').val(nama);
    $('#updateBon').val(bon);
    $('#updateKet').val(ket);

    $('#updateDataModal').modal('show');
});


    // Delete button handler
    $(document).on('click', '.delete', function() {
        const id = $(this).data('id');
        if (confirm('Are you sure you want to delete this row?')) {
            $.post('https://script.google.com/macros/s/AKfycbw3X4uIzp7cJn18PEVjcLFSMawp68gTDtzSaNCAyzshwSoXwfl9CMVXrQ2aMOhyet5wzg/exec', { action: 'Delete', id: id }, function(response) {
                alert(response.success || response.error);
                fetchData(); // Refresh the table data
            }, 'json');
        }
    });

    // Show add modal and clear form when "Add Data" button is clicked
    $('.btn[data-toggle="modal"]').on('click', function() {
        $('#addForm')[0].reset(); // Reset form fields
        $('#addDataModal').modal('show');
        getLastID(); // Ambil ID terakhir
        
    });
});

async function getLastID() {
    // Ambil semua baris di tabel
    const rows = document.querySelectorAll('#dataTable tbody tr');
    let lastID = 0;

    // Loop untuk menemukan ID terakhir
    rows.forEach(row => {
        const idCell = row.cells[0].textContent; // Misalkan ID berada di kolom pertama
        const idNumber = parseInt(idCell, 10); // Konversi ke angka
        if (!isNaN(idNumber) && idNumber > lastID) {
            lastID = idNumber; // Update lastID jika lebih besar
        }
    });

    // Set ID baru
    document.getElementById('addID').value = lastID + 1;
}

// Fungsi untuk mengatur tanggal sekarang
function setCurrentDate() {
    const today = new Date().toISOString().split('T')[0]; // Format YYYY-MM-DD
    document.getElementById('addTanggal').value = today; // Mengatur tanggal
}
function toggleSidebar() {
      const sidebar = document.getElementById('sidebarMenu');
      const mainContent = document.getElementById('mainContent');
      sidebar.classList.toggle('active');
      mainContent.classList.toggle('active');
    }

    function closeSidebar() {
      const sidebar = document.getElementById('sidebarMenu');
      const mainContent = document.getElementById('mainContent');
      sidebar.classList.remove('active'); // Remove the active class to close sidebar
      mainContent.classList.remove('active'); // Adjust main content margin if necessary
    }
    // Menampilkan loader saat data sedang dimuat
    function showLoader() {
        document.querySelector('.loader').style.display = 'block';
    }

    // Menghilangkan loader setelah data selesai dimuat
    function hideLoader() {
        document.querySelector('.loader').style.display = 'none';
    }
function confirmDelete(event) {
    event.preventDefault(); // Prevent the default action
    const correctPassword = '010199'; // Define the correct password
    const userPassword = prompt('Masukkan sandi untuk menghapus:'); // Prompt the user for a password
    
    if (userPassword === correctPassword) {
        // Code to delete the row, assuming `deleteRow` is a function that handles the deletion
        deleteRow(event.target.dataset.id); // Call the function to delete the row
    } else {
        alert('Sandi salah. Akses tidak diberikan.'); // Alert the user if the password is incorrect
    }
}

    // Contoh penggunaan: Menyembunyikan loader setelah 3 detik data dimuat
    document.addEventListener('DOMContentLoaded', function() {
        showLoader(); // Tampilkan loader ketika halaman dimuat
        setTimeout(hideLoader, 3000); // Sembunyikan loader setelah 3 detik
    });
    </script>
</body>
</html>
